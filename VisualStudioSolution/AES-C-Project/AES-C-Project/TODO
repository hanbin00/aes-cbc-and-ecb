need to be rewritten into a python module
maybe use Cython?
